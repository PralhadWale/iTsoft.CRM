<form #followUpForm="ngForm">
<mat-sidenav class="search-panel" position="end" position="end" dark #sidenav mode="push" opened="false">
    <mat-card class="profile-card">
      <mat-card-header>
        <div mat-card-avatar class="avatar">
          <mat-icon>queue</mat-icon>
        </div>
        <mat-card-title>
          {{requestTypeName}} Follow up
        </mat-card-title>
        <mat-card-title>
          {{requestNo}}
        </mat-card-title>
      </mat-card-header>
    </mat-card>
    <mat-nav-list style="margin-left:20px;"> 
      <input type="hidden" [(ngModel)]="followUP.FollowUpId" name="FollowUpId" />
      <input type="hidden" [(ngModel)]="followUP.RequestId" name="RequestId" />
      <input type="hidden" [(ngModel)]="followUP.RequestServiceId" name="RequestServiceId" />
      <mat-form-field appearance="outline">
        <mat-label>Service</mat-label>
        <input matInput type="text" placeholder="Service Name" name="ServiceName" [(ngModel)]="followUP.ServiceName"
          #Amount readonly />
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Lead Status</mat-label>
        <mat-select placeholder="Deal Status"  [(ngModel)]="followUP.LeadStatusId" name="LeadStatusId" [(value)]="followUP.LeadStatusId" #LeadStatusId="ngModel" required>
          <mat-option *ngFor="let item of requestSelectList.LeadStatuses" [value]="item.LeadStatusId">
            {{item.LeadStatusName}}
          </mat-option>
        </mat-select>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Stage</mat-label>
        <mat-select placeholder="Stage"  [(ngModel)]="followUP.StageId" name="StageId" [(value)]="followUP.StageId" #StageId="ngModel" required>
          <mat-option *ngFor="let item of requestSelectList.Stages" [value]="item.Value" >
            {{item.Text}} 
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Service Rate</mat-label>
        <input matInput type="number" placeholder="Rate" name="Amount" [(ngModel)]="followUP.Amount" #Amount
          readonly />
      </mat-form-field>
      <mat-form-field *ngIf="followUP.AgreedAmount > 0 || (followUP.LeadStatusId == 10010 || followUP.LeadStatusId == 10011 || followUP.LeadStatusId == 10012)" appearance="outline">
        <mat-label>Agreed Rate</mat-label>
        <input matInput type="number" placeholder="Agreed Rate" name="AgreedAmount" [(ngModel)]="followUP.AgreedAmount" #AgreedAmount [required]="followUpDetails.RequestTypeId == 2"/>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Follow up date</mat-label>
        <input matInput [matDatepicker]="followUpDate" [min]="minDate" [(ngModel)]="followUP.FollowUpDate" name="FollowUpDate" required>
        <mat-datepicker-toggle matSuffix [for]="followUpDate"></mat-datepicker-toggle>
        <mat-datepicker #followUpDate color="primary"></mat-datepicker>
        <mat-error>FollowUp Date is required.</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Remark</mat-label>
          <textarea matInput placeholder="Remark" name="Remark" [(ngModel)]="followUP.Remark"  #Remark [required]="followUP.LeadStatusId == 10013 || followUP.LeadStatusId == 10014"
            cdkAutosizeMinRows="1" cdkAutosizeMaxRows="5"></textarea>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Client Rating</mat-label>
        <input matInput type="number" placeholder="Client Rating" name="ClientRating" [(ngModel)]="followUP.ClientRating"
          #ClientRating required/>
      </mat-form-field>

    <mat-form-field *ngIf="(!(followUP.LeadStatusId == 10011 || followUP.LeadStatusId == 10012 || followUP.LeadStatusId == 10013 || followUP.LeadStatusId == 10014))" appearance="outline">
      <mat-label>Next follow up date</mat-label>
      <input matInput [matDatepicker]="nextFollowupDate" [min]="nextMinDate" [(ngModel)]="followUP.NextFollowupDate" name="NextFollowupDate" required>
      <mat-datepicker-toggle matSuffix [for]="nextFollowupDate"></mat-datepicker-toggle>
      <mat-datepicker #nextFollowupDate color="primary"></mat-datepicker>
      <mat-error>Next Date is required.</mat-error>
    </mat-form-field>
    <!-- <div class="form-group form-check" *ngIf="!IsCompleted">
      <mat-checkbox name="IsCompleted" id="IsCompleted" class="form-check-input"
        [(ngModel)]="followUP.IsCompleted" #IsCompleted="ngModel">Mark Completed</mat-checkbox>
    </div>
    <mat-form-field *ngIf="IsCompleted">
      <input matInput type="text" placeholder="Follow up Status" name="IsCompleted" value="Completed"   #IsCompleted readonly/>
    </mat-form-field> -->
    </mat-nav-list>
    <mat-divider></mat-divider>
    <mat-card-header>
      <mat-action-list>
        <button mat-raised-button style="color:lightgrey; background-color:darkgreen; margin:5px;"
          (click)="onSubmit(followUpForm)"  *ngIf="!IsCompleted">
          <mat-icon>save</mat-icon>Save
        </button>
        <button mat-raised-button style="color:lightgrey; background-color:darkred;margin:5px;"
          (click)="onCancelClick()">
          <mat-icon>cancel</mat-icon>Cancel
        </button>
      </mat-action-list>
    </mat-card-header>
  </mat-sidenav>
</form>